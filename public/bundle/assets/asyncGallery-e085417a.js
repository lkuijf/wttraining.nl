class n{constructor(e){this.settings={images:".gallery_image",loop:!0,next:void 0,prev:void 0,dots:void 0,close:void 0,loader:void 0,counter:void 0,counterDivider:"/",keyboardNavigation:!0,hiddenElements:[]},Object.assign(this.settings,e),this.gallery=null,this.index=0,this.items=[...document.querySelectorAll(this.settings.images)],this.addedItems={},this.touch={endX:0,startX:0},this.init()}get loading(){return!this.settings.hiddenElements.includes("loader")}get dotsVisible(){return!this.settings.hiddenElements.includes("dots")}init(){this.clearUncomplete(),this.createElements(),this.bindEvents()}clearUncomplete(){this.items=this.items.filter(e=>e.dataset.large)}createElements(){this.gallery=document.createElement("DIV"),this.gallery.classList.add("asyncGallery"),this.createSingleElement({element:"prev",type:"BUTTON",event:"click",func:this.getPrevious}),this.createSingleElement({element:"next",type:"BUTTON",event:"click",func:this.getNext}),this.createSingleElement({element:"close",type:"BUTTON",event:"click",func:this.closeGallery}),this.createSingleElement({element:"loader",type:"SPAN",text:"Loading..."}),this.createSingleElement({element:"counter",type:"SPAN",text:"0/0"}),this.createSingleElement({element:"dots",type:"UL",text:""}),this.settings.hiddenElements.includes("dots")||this.items.forEach((e,i)=>{let t=document.createElement("LI");t.dataset.index=i;let s=document.createElement("BUTTON");s.innerHTML=i,s.addEventListener("click",()=>{this.index=i,this.getItem(i)}),t.append(s),this.dots.append(t)}),window.document.body.append(this.gallery)}createSingleElement({element:e,type:i,event:t="click",func:s,text:l}){this.settings.hiddenElements.includes(e)||(this.settings[e]?(this[e]=document.querySelector(this.settings[e]),this.gallery.append(this[e])):(this[e]=document.createElement(i),this[e].classList.add(`asyncGallery__${this.capitalizeFirstLetter(e)}`),this[e].innerHTML=l!==void 0?l:e,this.gallery.append(this[e])),s&&this[e].addEventListener(t,s.bind(this)))}getItem(e,i=null){let t=i;if(t===null&&(t={},t.src=this.items[e].dataset.large,t.description=this.items[e].dataset.description),this.settings.hiddenElements.includes("counter")||(this.counter.innerHTML=`
            <span class="asyncGallery__Current">${this.index+1}</span>${this.settings.counterDivider}<span class="asyncGallery__Current">${this.items.length}</span>
            `),this.addedItems.hasOwnProperty(e))this.clearVisible(),this.addedItems[this.index].loaded?(this.addedItems[this.index].classList.add("is-visible"),this.loading&&this.loader.classList.remove("is-visible")):this.loading&&this.loader.classList.add("is-visible"),this.dotsVisible&&this.gallery.querySelector(`.asyncGallery__Dots li[data-index="${e}"]`).classList.add("is-active");else{let s=document.createElement("IMG"),l=document.createElement("DIV");l.classList.add("asyncGallery__Item"),this.loading&&this.loader.classList.add("is-visible"),this.clearVisible(),this.dotsVisible&&this.gallery.querySelector(`.asyncGallery__Dots li[data-index="${e}"]`).classList.add("is-active"),s.src=t.src,s.alt=t.description?t.description:"",l.innerHTML=`
            <div class="asyncGallery__ItemImage">
              ${s.outerHTML}
            </div>
            `,t.description&&(l.innerHTML+=`
              <div class="asyncGallery__ItemDescription">
                <p>${t.description}</p>
              </div>
              `),this.gallery.append(l),this.addedItems[e]=l,s.addEventListener("load",()=>{this.addedItems[e].loaded=!0,this.gallery.querySelector(".asyncGallery__Item.is-visible")||this.addedItems[e].classList.add("is-visible"),this.loading&&this.loader.classList.remove("is-visible")})}this.settings.loop||(this.index===0?this.prev.setAttribute("disabled",!0):this.prev.removeAttribute("disabled"),this.index===this.items.length-1?this.next.setAttribute("disabled",!0):this.next.removeAttribute("disabled"))}clearVisible(){this.gallery.querySelector(".asyncGallery__Item.is-visible")&&this.gallery.querySelector(".asyncGallery__Item.is-visible").classList.remove("is-visible"),this.gallery.querySelector(".asyncGallery__Dots li.is-active")&&this.gallery.querySelector(".asyncGallery__Dots li.is-active").classList.remove("is-active")}closeGallery(){this.gallery.classList.remove("is-visible"),this.clearVisible()}capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}handleGesure(){this.touch.endX>this.touch.startX+20?this.getPrevious():this.touch.endX<this.touch.startX-20&&this.getNext()}getPrevious(){this.settings.loop?(this.index--,this.index===-1&&(this.index=this.items.length-1),this.getItem(this.index)):this.index>0&&(this.index--,this.getItem(this.index))}getNext(){this.settings.loop?(this.index++,this.index===this.items.length&&(this.index=0),this.getItem(this.index)):this.index<this.items.length-1&&(this.index++,this.getItem(this.index))}bindEvents(){this.items.forEach((e,i)=>{e.addEventListener("click",t=>{this.gallery.classList.add("is-visible"),this.index=i,this.getItem(i,{src:t.target.dataset.large,description:t.target.dataset.description})})}),document.addEventListener("keyup",e=>{this.gallery.classList.contains("is-visible")&&(e.key==="Escape"&&this.closeGallery(),this.settings.keyboardNavigation&&(e.keyCode===39?this.getNext():e.keyCode===37&&this.getPrevious()))}),this.gallery.addEventListener("touchstart",e=>{this.touch.startX=e.changedTouches[0].screenX},!1),this.gallery.addEventListener("touchend",e=>{this.touch.endX=e.changedTouches[0].screenX,this.handleGesure()},!1)}}new n;
